{% set image_name = image_name or 'cirros' %}
{% set flavor_name = flavor_name or 'm1.xtiny' %}
{% set num_vms = num_vms or 1 %}
{% set num_migrate_vms = num_migrate_vms or 1 %}
{% set workloads = workloads or 'all' %}
{% set octavia_image_name = octavia_image_name or 'custom-cirros' %}
{% set octavia_flavor_name = octavia_flavor_name or 'm1.tiny-cirros' %}
{% set num_lbs = num_lbs or 2 %}
{% set num_pools = num_pools or 2 %}
{% set num_clients = num_clients or 2 %}
{% set user = user or 'cirros' %}
{% set sla_max_avg_duration = sla_max_avg_duration or 60 %}
{% set sla_max_failure = sla_max_failure or 0 %}
{% set sla_max_seconds = sla_max_seconds or 60 %}
---
BrowbeatPlugin.dynamic_workload:
-
    args:
      floating: True
      flavor:
        name: '{{flavor_name}}'
      image:
        name: '{{image_name}}'
      user: '{{ user }}'
      jump_host_ip: '{{ jump_host_ip }}'
      octavia_image:
         name: '{{ octavia_image_name }}'
      octavia_flavor:
        name: '{{ octavia_flavor_name }}'
      num_lbs: {{ num_lbs }}
      num_pools: {{ num_pools }}
      num_clients: {{ num_clients }}
      vip_subnet_id: '{{ vip_subnet_id }}'
      user_data_file: '{{ user_data_file }}'
      network_create_args: {}
      router_create_args: {}
      subnet_create_args: {}
      num_vms: {{num_vms}}
      num_migrate_vms: {{num_migrate_vms}}
      ext_net_id: '{{ext_net_id}}'
      workloads: '{{workloads}}'
    runner:
      concurrency: {{concurrency}}
      times: {{times}}
      type: "constant"
    context:
      users:
        tenants: 1
        users_per_tenant: 1
      quotas:
        neutron:
          network: -1
          port: -1
          router: -1
          subnet: -1
          floatingip: -1
        nova:
          instances: -1
          cores: -1
          ram: -1
    sla:
      max_avg_duration: {{sla_max_avg_duration}}
      max_seconds_per_iteration: {{sla_max_seconds}}
      failure_rate:
        max: {{sla_max_failure}}
